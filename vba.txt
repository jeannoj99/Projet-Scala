Sub ConcatenerFeuillesForcage()
    Dim dossier As String
    Dim fichier As String
    Dim wbSource As Workbook
    Dim wsSource As Worksheet
    Dim wbDest As Workbook
    Dim wsDest As Worksheet
    Dim derniereLigneSrc As Long
    Dim derniereColSrc As Long
    Dim derniereLigneDest As Long
    Dim cheminComplet As String
    Dim premierFichier As Boolean
    Dim ligneDepart As Long
    Dim ws As Worksheet
    
    ' Sélection du dossier contenant les fichiers
    With Application.FileDialog(msoFileDialogFolderPicker)
        .Title = "Sélectionne le dossier contenant les fichiers Excel"
        If .Show <> -1 Then Exit Sub
        dossier = .SelectedItems(1) & "\"
    End With
    
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    ' Feuille de destination
    Set wbDest = ThisWorkbook
    On Error Resume Next
    Set wsDest = wbDest.Sheets("Concat_Forçage")
    If wsDest Is Nothing Then
        Set wsDest = wbDest.Sheets.Add
        wsDest.Name = "Concat_Forçage"
    End If
    wsDest.Cells.Clear
    On Error GoTo 0
    
    premierFichier = True
    
    ' Parcours des fichiers Excel
    fichier = Dir(dossier & "*.xls*")
    Do While fichier <> ""
        cheminComplet = dossier & fichier
        
        If cheminComplet <> wbDest.FullName Then
            Set wbSource = Workbooks.Open(cheminComplet, ReadOnly:=True)
            
            ' Recherche de la feuille "forçage" (tolérance casse/accents)
            Set wsSource = Nothing
            For Each ws In wbSource.Sheets
                If LCase(Replace(ws.Name, "ç", "c")) = "forcage" Then
                    Set wsSource = ws
                    Exit For
                End If
            Next ws
            
            If Not wsSource Is Nothing Then
                ' Trouver dernière ligne et dernière colonne utilisées (pas seulement la colonne A)
                derniereLigneSrc = wsSource.Cells.Find("*", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row
                derniereColSrc = wsSource.Cells.Find("*", SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column
                
                ' Définir ligne de départ
                If premierFichier Then
                    ligneDepart = 1
                    premierFichier = False
                Else
                    ligneDepart = 5
                End If
                
                ' Dernière ligne occupée dans feuille de destination
                If Application.WorksheetFunction.CountA(wsDest.Cells) = 0 Then
                    derniereLigneDest = 1
                Else
                    derniereLigneDest = wsDest.Cells.Find("*", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row + 1
                End If
                
                ' Copier plage entière (A1 -> dernière cellule)
                wsSource.Range(wsSource.Cells(ligneDepart, 1), wsSource.Cells(derniereLigneSrc, derniereColSrc)).Copy _
                    wsDest.Cells(derniereLigneDest, 1)
            End If
            
            wbSource.Close SaveChanges:=False
        End If
        
        fichier = Dir
    Loop
    
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    
    MsgBox "Concaténation terminée avec en-têtes du premier fichier.", vbInformation
End Sub